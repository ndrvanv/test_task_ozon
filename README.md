# Ozon Data Loader

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ JSON –≤ SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ozon_data_loader/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ ozon_orders.json        # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
‚îÇ
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îî‚îÄ‚îÄ orders.db               # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite —Å —Ç–∞–±–ª–∏—Ü–µ–π –∑–∞–∫–∞–∑–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ app.log                 # –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8
‚îÇ
‚îú‚îÄ‚îÄ main.py                     # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ database.py                 # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ utils.py                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
```

## ‚ñ∂Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.x**
2. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞**:
   - –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫–∏: `data`, `db`, `logs`
   - –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à JSON-—Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `data/` —Å –∏–º–µ–Ω–µ–º `ozon_orders.json`
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç**:
   ```bash
   python main.py
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –≤ `db/orders.db`
   - –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∞–Ω—ã –≤ `logs/app.log`

## üîÑ –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å

–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**:
   - –°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `orders` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**:
   - –ß—Ç–µ–Ω–∏–µ JSON-—Ñ–∞–π–ª–∞ –∏–∑ –ø–∞–ø–∫–∏ `data/`
   - –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π:
     - `order_id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞
     - `status` - —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
     - `date` - –¥–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ (–≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ)
     - `amount` - —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞
     - `customer_region` - —Ä–µ–≥–∏–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞ (–∏–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è)

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ `order_id`
   - –í—Å—Ç–∞–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

4. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**:
   - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
   - –ó–∞–ø–∏—Å—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã

## üìú –ö–∞–∫–∏–µ —à–∞–≥–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

–í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/app.log` —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8:

- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: 
  - "–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤"
  - "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" / "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞"

- **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**:
  - "–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ data/ozon_orders.json"
  - "–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ JSON" –∏–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤**:
  - "–ó–∞–∫–∞–∑ {order_id} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º" (–¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
  - "–ó–∞–∫–∞–∑ {order_id} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω" (–¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤)
  - –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –∏–ª–∏ –≤—Å—Ç–∞–≤–∫–µ –∑–∞–∫–∞–∑–æ–≤

- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**:
  - "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞"

## üîç –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. **–ü–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞** –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `order_exists(order_id)`
2. **–§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å**:
   ```sql
   SELECT 1 FROM orders WHERE order_id = ?
   ```
3. **–ï—Å–ª–∏ –∑–∞–∫–∞–∑ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**:
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥: "–ó–∞–∫–∞–∑ {order_id} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
   - –ó–∞–∫–∞–∑ –Ω–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
4. **–ï—Å–ª–∏ –∑–∞–∫–∞–∑ —É–Ω–∏–∫–∞–ª–µ–Ω**:
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ª–æ–≥: "–ó–∞–∫–∞–∑ {order_id} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω"

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö —Å–∫—Ä–∏–ø—Ç–∞ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –∑–∞–∫–∞–∑—ã –Ω–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.x** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **SQLite** - –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ú–æ–¥—É–ª—å logging** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π UTF-8
- **JSON** - —Ñ–æ—Ä–º–∞—Ç –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã orders

```sql
CREATE TABLE orders (
    order_id TEXT PRIMARY KEY,
    status TEXT,
    date TEXT,
    amount REAL,
    customer_region TEXT
);
```